---
description: the structure of the project
globs:
alwaysApply: false
---

## 1. Project Directory Structure

NOTE: always verify with a 'tree' search of the project

-   **`.venv/`**: Python virtual environment.
-   **`app/`**: Desktop application (daemon + legacy UI).
    -   **`daemon/`**: Primary mode — lightweight background service with floating indicator.
        -   `whisper_daemon.py`, `recording_indicator.py`, `hotkey_listener.py`
    -   **`core/`**: Shared services — audio recording, transcription (whisper.cpp + faster-whisper), post-processing, Fabric.
    -   **`ui/`**: Legacy full-window UI (PySide6, secondary).
    -   **`utils/`**: Config manager, helpers.
-   **`kb/`**: Knowledge Base CLI — the most actively developed module.
    -   **`__main__.py`**: CLI entry point (`python -m kb`).
    -   **`core.py`**: Shared utils (transcribe_to_kb, registry, format_timestamp).
    -   **`analyze.py`**: LLM analysis via Gemini API.
    -   **`prompts.py`**: Prompt formatting + template substitution.
    -   **`judge.py`**: LLM judge loop for iterative improvement.
    -   **`render.py`**: Carousel HTML rendering (Jinja2) + PDF generation (Playwright).
    -   **`publish.py`**: CLI for carousel rendering pipeline.
    -   **`serve.py`**: Flask web dashboard (action queue, browse mode).
    -   **`serve_state.py`**, **`serve_scanner.py`**, **`serve_visual.py`**: Serve module helpers.
    -   **`config.py`**: KB_ROOT, config loading, defaults.
    -   **`transcription.py`**: Transcription service imports.
    -   **`sources/`**: Transcription source handlers (file, cap, volume, zoom, paste).
    -   **`config/`**: Repo copy of analysis type configs. NOTE: runtime loads from `KB_ROOT/config/`, not here.
    -   **`carousel_templates/`**: HTML templates, config.json, mockups for carousel rendering.
    -   **`tests/`**: KB module test suite (~400 tests).
-   **`deploy/`**: Server deployment scripts (`deploy-kb-serve.sh`, systemd service).
-   **`scripts/`**: Helper scripts.
    -   `whisper-daemon.sh`: Start/stop/status for daemon mode.
    -   **`raycast/`**: Raycast quick-access scripts for KB dashboard.
-   **`tasks/`**: Task management (GTM, active/completed/archived tasks).
-   **`resources/`**: App icons and static assets.
-   **`transcribe_file.py`**: Standalone Raycast file transcription with caching.
-   **`requirements.txt`**: Python dependencies.
-   **`CLAUDE.md`**: AI agent instructions (key rules, architecture, commands).
